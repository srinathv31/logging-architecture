---
title: cn() Utility for Class Merging
impact: HIGH
impactDescription: ensures proper conditional styling and class conflict resolution
tags: shadcn, cn, clsx, tailwind-merge, styling, classes
---

## cn() Utility for Class Merging

Use the `cn()` utility (clsx + tailwind-merge) for conditional classes and style overrides. Don't use string concatenation.

**Incorrect (string concatenation):**

```tsx
// DON'T DO THIS - string concatenation doesn't merge Tailwind classes properly
function Button({ className, variant }) {
  const baseClasses = "px-4 py-2 rounded-md"
  const variantClasses = variant === "primary" ? "bg-blue-500" : "bg-gray-500"

  return (
    <button className={`${baseClasses} ${variantClasses} ${className}`}>
      Click me
    </button>
  )
}

// Problem: className="bg-red-500" won't override bg-blue-500
// Result: "px-4 py-2 rounded-md bg-blue-500 bg-red-500" - conflict!
```

**Correct (using cn()):**

```tsx
import { cn } from "@/lib/utils"

function Button({ className, variant }) {
  return (
    <button
      className={cn(
        "px-4 py-2 rounded-md",
        variant === "primary" ? "bg-blue-500" : "bg-gray-500",
        className
      )}
    >
      Click me
    </button>
  )
}

// className="bg-red-500" properly overrides the variant color
// Result: "px-4 py-2 rounded-md bg-red-500" - merged correctly!
```

**How cn() works:**

```tsx
import { type ClassValue, clsx } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

// clsx: Handles conditional classes
// twMerge: Resolves Tailwind class conflicts
```

**Common patterns:**

```tsx
// Conditional classes
cn(
  "base-class",
  isActive && "active-class",
  isDisabled && "opacity-50 cursor-not-allowed"
)

// Object syntax
cn(
  "base-class",
  {
    "text-red-500": hasError,
    "text-green-500": isSuccess,
  }
)

// Array syntax
cn([
  "base-class",
  variant === "primary" && "primary-class",
])

// Forwarding className prop (always last)
cn(
  "default-styles",
  variantStyles,
  className  // Consumer overrides go last
)
```

**Component example:**

```tsx
import { cn } from "@/lib/utils"
import { ButtonHTMLAttributes, forwardRef } from "react"

interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: "default" | "destructive" | "outline"
  size?: "default" | "sm" | "lg"
}

const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant = "default", size = "default", ...props }, ref) => {
    return (
      <button
        className={cn(
          // Base styles
          "inline-flex items-center justify-center rounded-md font-medium transition-colors",
          "focus-visible:outline-none focus-visible:ring-2",
          // Variant styles
          {
            "bg-primary text-primary-foreground hover:bg-primary/90":
              variant === "default",
            "bg-destructive text-destructive-foreground hover:bg-destructive/90":
              variant === "destructive",
            "border border-input bg-background hover:bg-accent":
              variant === "outline",
          },
          // Size styles
          {
            "h-10 px-4 py-2": size === "default",
            "h-9 px-3": size === "sm",
            "h-11 px-8": size === "lg",
          },
          // Consumer overrides
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
```

**Guidelines:**

- Always use cn() for component className props
- Put the `className` prop last so consumers can override
- Use object syntax for multiple conditional classes
- The cn() utility is generated by `npx shadcn@latest init`
- Tailwind-merge handles conflicts like `p-4` vs `p-2` correctly
