{
  "version": "2",
  "dialect": "mssql",
  "id": "db30057e-e03c-4348-b000-39f412b2c29d",
  "prevIds": [
    "00000000-0000-0000-0000-000000000000"
  ],
  "ddl": [
    {
      "name": "event_logs",
      "entityType": "tables",
      "schema": "dbo"
    },
    {
      "name": "correlation_links",
      "entityType": "tables",
      "schema": "dbo"
    },
    {
      "name": "process_definitions",
      "entityType": "tables",
      "schema": "dbo"
    },
    {
      "name": "account_timeline_summary",
      "entityType": "tables",
      "schema": "dbo"
    },
    {
      "type": "bigint",
      "notNull": true,
      "generated": null,
      "identity": {
        "seed": 1,
        "increment": 1
      },
      "name": "event_log_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(36)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "execution_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(200)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "correlation_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(64)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "account_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(200)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "trace_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(64)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "span_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(64)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "parent_span_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "nvarchar(max)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "span_links",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(200)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "batch_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(200)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "application_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(200)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "target_system",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(200)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "originating_system",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(510)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "process_name",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "int",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "step_sequence",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(510)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "step_name",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(50)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "event_type",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(50)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "event_status",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "nvarchar(max)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "identifiers",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "nvarchar(max)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "summary",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(2048)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "result",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "nvarchar(max)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "metadata",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "datetime2(3)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "event_timestamp",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "datetime2(3)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "created_at",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "int",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "execution_time_ms",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(510)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "endpoint",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "int",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "http_status_code",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(20)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "http_method",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(100)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "error_code",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(2048)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "error_message",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "nvarchar(max)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "request_payload",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "nvarchar(max)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "response_payload",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(128)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "idempotency_key",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "bit",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "is_deleted",
      "schema": "dbo",
      "entityType": "columns",
      "table": "event_logs"
    },
    {
      "type": "varchar(200)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "correlation_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "correlation_links"
    },
    {
      "type": "varchar(64)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "account_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "correlation_links"
    },
    {
      "type": "varchar(100)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "application_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "correlation_links"
    },
    {
      "type": "varchar(100)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "customer_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "correlation_links"
    },
    {
      "type": "varchar(4)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "card_number_last4",
      "schema": "dbo",
      "entityType": "columns",
      "table": "correlation_links"
    },
    {
      "type": "datetime2(3)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "linked_at",
      "schema": "dbo",
      "entityType": "columns",
      "table": "correlation_links"
    },
    {
      "type": "int",
      "notNull": true,
      "generated": null,
      "identity": {
        "seed": 1,
        "increment": 1
      },
      "name": "process_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "varchar(510)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "process_name",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "varchar(510)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "display_name",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "nvarchar(max)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "description",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "varchar(200)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "owning_team",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "int",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "expected_steps",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "int",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "sla_ms",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "bit",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "is_active",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "datetime2(3)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "created_at",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "datetime2(3)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "updated_at",
      "schema": "dbo",
      "entityType": "columns",
      "table": "process_definitions"
    },
    {
      "type": "varchar(64)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "account_id",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "type": "datetime2(3)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "first_event_at",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "type": "datetime2(3)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "last_event_at",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "type": "int",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "total_events",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "type": "int",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "total_processes",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "type": "int",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "error_count",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "type": "varchar(510)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "last_process",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "type": "nvarchar(max)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "systems_touched",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "type": "nvarchar(max)",
      "notNull": false,
      "generated": null,
      "identity": null,
      "name": "correlation_ids",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "type": "datetime2(3)",
      "notNull": true,
      "generated": null,
      "identity": null,
      "name": "updated_at",
      "schema": "dbo",
      "entityType": "columns",
      "table": "account_timeline_summary"
    },
    {
      "columns": [
        {
          "value": "correlation_id",
          "isExpression": false
        },
        {
          "value": "event_timestamp",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_event_logs_correlation_id",
      "entityType": "indexes",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "account_id",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_event_logs_account_id",
      "entityType": "indexes",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "trace_id",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_event_logs_trace_id",
      "entityType": "indexes",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "process_name",
          "isExpression": false
        },
        {
          "value": "event_timestamp",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_event_logs_process",
      "entityType": "indexes",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "event_timestamp",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_event_logs_timestamp",
      "entityType": "indexes",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "event_status",
          "isExpression": false
        },
        {
          "value": "event_timestamp",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_event_logs_status",
      "entityType": "indexes",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "target_system",
          "isExpression": false
        },
        {
          "value": "event_timestamp",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_event_logs_target_system",
      "entityType": "indexes",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "idempotency_key",
          "isExpression": false
        }
      ],
      "isUnique": true,
      "where": null,
      "name": "ix_event_logs_idempotency",
      "entityType": "indexes",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "batch_id",
          "isExpression": false
        },
        {
          "value": "correlation_id",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_event_logs_batch_id",
      "entityType": "indexes",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "account_id",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_correlation_links_account_id",
      "entityType": "indexes",
      "table": "correlation_links",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "application_id",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_correlation_links_application_id",
      "entityType": "indexes",
      "table": "correlation_links",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "process_name",
          "isExpression": false
        }
      ],
      "isUnique": true,
      "where": null,
      "name": "ix_process_definitions_name",
      "entityType": "indexes",
      "table": "process_definitions",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "owning_team",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_process_definitions_owning_team",
      "entityType": "indexes",
      "table": "process_definitions",
      "schema": "dbo"
    },
    {
      "columns": [
        {
          "value": "last_event_at",
          "isExpression": false
        }
      ],
      "isUnique": false,
      "where": null,
      "name": "ix_account_timeline_summary_last_event",
      "entityType": "indexes",
      "table": "account_timeline_summary",
      "schema": "dbo"
    },
    {
      "nameExplicit": false,
      "columns": [
        "event_log_id"
      ],
      "name": "event_logs_pkey",
      "table": "event_logs",
      "schema": "dbo",
      "entityType": "pks"
    },
    {
      "nameExplicit": false,
      "columns": [
        "correlation_id"
      ],
      "name": "correlation_links_pkey",
      "table": "correlation_links",
      "schema": "dbo",
      "entityType": "pks"
    },
    {
      "nameExplicit": false,
      "columns": [
        "process_id"
      ],
      "name": "process_definitions_pkey",
      "table": "process_definitions",
      "schema": "dbo",
      "entityType": "pks"
    },
    {
      "nameExplicit": false,
      "columns": [
        "account_id"
      ],
      "name": "account_timeline_summary_pkey",
      "table": "account_timeline_summary",
      "schema": "dbo",
      "entityType": "pks"
    },
    {
      "column": "execution_id",
      "nameExplicit": false,
      "default": "(LOWER(CONVERT(VARCHAR(36), NEWID())))",
      "name": "event_logs_execution_id_default",
      "entityType": "defaults",
      "schema": "dbo",
      "table": "event_logs"
    },
    {
      "column": "created_at",
      "nameExplicit": false,
      "default": "(GETUTCDATE())",
      "name": "event_logs_created_at_default",
      "entityType": "defaults",
      "schema": "dbo",
      "table": "event_logs"
    },
    {
      "column": "is_deleted",
      "nameExplicit": false,
      "default": "((0))",
      "name": "event_logs_is_deleted_default",
      "entityType": "defaults",
      "schema": "dbo",
      "table": "event_logs"
    },
    {
      "column": "linked_at",
      "nameExplicit": false,
      "default": "(GETUTCDATE())",
      "name": "correlation_links_linked_at_default",
      "entityType": "defaults",
      "schema": "dbo",
      "table": "correlation_links"
    },
    {
      "column": "is_active",
      "nameExplicit": false,
      "default": "((1))",
      "name": "process_definitions_is_active_default",
      "entityType": "defaults",
      "schema": "dbo",
      "table": "process_definitions"
    },
    {
      "column": "created_at",
      "nameExplicit": false,
      "default": "(GETUTCDATE())",
      "name": "process_definitions_created_at_default",
      "entityType": "defaults",
      "schema": "dbo",
      "table": "process_definitions"
    },
    {
      "column": "updated_at",
      "nameExplicit": false,
      "default": "(GETUTCDATE())",
      "name": "process_definitions_updated_at_default",
      "entityType": "defaults",
      "schema": "dbo",
      "table": "process_definitions"
    },
    {
      "column": "error_count",
      "nameExplicit": false,
      "default": "((0))",
      "name": "account_timeline_summary_error_count_default",
      "entityType": "defaults",
      "schema": "dbo",
      "table": "account_timeline_summary"
    },
    {
      "column": "updated_at",
      "nameExplicit": false,
      "default": "(GETUTCDATE())",
      "name": "account_timeline_summary_updated_at_default",
      "entityType": "defaults",
      "schema": "dbo",
      "table": "account_timeline_summary"
    },
    {
      "value": "[event_logs].[event_type] IN ('PROCESS_START', 'STEP', 'PROCESS_END', 'ERROR')",
      "name": "ck_event_logs_event_type",
      "entityType": "checks",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "value": "[event_logs].[event_status] IN ('SUCCESS', 'FAILURE', 'IN_PROGRESS', 'SKIPPED')",
      "name": "ck_event_logs_event_status",
      "entityType": "checks",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "value": "[event_logs].[http_method] IS NULL OR [event_logs].[http_method] IN ('GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS')",
      "name": "ck_event_logs_http_method",
      "entityType": "checks",
      "table": "event_logs",
      "schema": "dbo"
    },
    {
      "value": "[event_logs].[span_links] IS NULL OR ISJSON([event_logs].[span_links]) = 1",
      "name": "ck_event_logs_span_links_json",
      "entityType": "checks",
      "table": "event_logs",
      "schema": "dbo"
    }
  ],
  "renames": []
}